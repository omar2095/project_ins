<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Health Monitor — Professional Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<style>
:root{
  --bg-primary:#0a0e27;
  --bg-secondary:#0f1629;
  --bg-card:#151b2e;
  --accent-blue:#3b82f6;
  --accent-cyan:#06b6d4;
  --accent-green:#10b981;
  --accent-purple:#8b5cf6;
  --accent-red:#ef4444;
  --accent-orange:#f59e0b;
  --text-primary:#f8fafc;
  --text-secondary:#94a3b8;
  --text-muted:#64748b;
  --border:rgba(148,163,184,0.1);
  --glow-blue:rgba(59,130,246,0.4);
  --glow-green:rgba(16,185,129,0.4);
  --glow-red:rgba(239,68,68,0.4);
}

*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:'Inter',sans-serif;
  background:var(--bg-primary);
  color:var(--text-primary);
  overflow-x:hidden;
  position:relative;
}

/* خلفية متحركة خيالية */
.animated-bg{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  z-index:0;
  opacity:0.4;
  pointer-events:none;
}
.animated-bg::before,
.animated-bg::after{
  content:'';
  position:absolute;
  border-radius:50%;
  filter:blur(80px);
  animation:float 20s infinite ease-in-out;
}
.animated-bg::before{
  width:600px;height:600px;
  background:radial-gradient(circle,var(--accent-blue),transparent);
  top:-200px;right:-200px;
  animation-delay:0s;
}
.animated-bg::after{
  width:500px;height:500px;
  background:radial-gradient(circle,var(--accent-purple),transparent);
  bottom:-150px;left:-150px;
  animation-delay:5s;
}

@keyframes float{
  0%,100%{transform:translate(0,0) scale(1);}
  33%{transform:translate(100px,-100px) scale(1.1);}
  66%{transform:translate(-100px,100px) scale(0.9);}
}

/* Navbar خيالي */
.navbar{
  position:relative;
  z-index:1000;
  background:rgba(15,22,41,0.8);
  backdrop-filter:blur(20px);
  border-bottom:1px solid var(--border);
  padding:16px 32px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  box-shadow:0 8px 32px rgba(0,0,0,0.3);
}
.brand{
  display:flex;
  align-items:center;
  gap:16px;
  font-size:24px;
  font-weight:800;
  letter-spacing:-0.5px;
}
.brand .icon-pulse{
  width:48px;height:48px;
  border-radius:16px;
  background:linear-gradient(135deg,var(--accent-blue),var(--accent-cyan));
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  box-shadow:0 8px 24px var(--glow-blue);
  animation:pulse-icon 2s infinite;
}
.brand .icon-pulse i{
  font-size:24px;
  color:#fff;
}
@keyframes pulse-icon{
  0%,100%{transform:scale(1);box-shadow:0 8px 24px var(--glow-blue);}
  50%{transform:scale(1.05);box-shadow:0 12px 36px var(--glow-blue);}
}

.nav-right{
  display:flex;
  gap:12px;
  align-items:center;
}

.status-indicator{
  display:flex;
  align-items:center;
  gap:12px;
  padding:12px 20px;
  background:var(--bg-card);
  border-radius:12px;
  border:1px solid var(--border);
}
.status-dot{
  width:12px;height:12px;
  border-radius:50%;
  background:var(--accent-green);
  box-shadow:0 0 20px var(--glow-green);
  animation:pulse-dot 2s infinite;
}
@keyframes pulse-dot{
  0%,100%{opacity:1;transform:scale(1);}
  50%{opacity:0.6;transform:scale(1.2);}
}
.status-text{
  font-size:14px;
  font-weight:600;
}
.status-subtext{
  font-size:12px;
  color:var(--text-muted);
}

.btn{
  padding:12px 24px;
  border-radius:12px;
  font-weight:600;
  font-size:14px;
  cursor:pointer;
  border:none;
  display:flex;
  align-items:center;
  gap:8px;
  transition:all 0.3s ease;
  position:relative;
  overflow:hidden;
}
.btn::before{
  content:'';
  position:absolute;
  top:50%;left:50%;
  width:0;height:0;
  border-radius:50%;
  background:rgba(255,255,255,0.2);
  transform:translate(-50%,-50%);
  transition:width 0.6s,height 0.6s;
}
.btn:hover::before{
  width:300px;height:300px;
}
.btn-emergency{
  background:linear-gradient(135deg,var(--accent-red),#dc2626);
  color:#fff;
  box-shadow:0 8px 24px var(--glow-red);
}
.btn-emergency:hover{
  transform:translateY(-2px);
  box-shadow:0 12px 32px var(--glow-red);
}
.btn-profile{
  background:linear-gradient(135deg,var(--accent-blue),var(--accent-purple));
  color:#fff;
  box-shadow:0 8px 24px var(--glow-blue);
}
.btn-profile:hover{
  transform:translateY(-2px);
  box-shadow:0 12px 32px var(--glow-blue);
}

/* Alert Banner */
#criticalAlert{
  position:fixed;
  top:0;left:0;
  width:100%;
  padding:20px;
  background:linear-gradient(135deg,var(--accent-red),#dc2626);
  color:#fff;
  font-weight:700;
  font-size:18px;
  text-align:center;
  display:none;
  z-index:10000;
  box-shadow:0 8px 32px rgba(239,68,68,0.6);
  animation:alert-shake 0.5s infinite;
}
@keyframes alert-shake{
  0%,100%{transform:translateX(0);}
  25%{transform:translateX(-5px);}
  75%{transform:translateX(5px);}
}

/* Container */
.container{
  position:relative;
  z-index:1;
  max-width:1600px;
  margin:0 auto;
  padding:32px;
}

/* Top Section */
.top-section{
  display:flex;
  justify-content:space-between;
  align-items:flex-start;
  gap:24px;
  margin-bottom:32px;
  flex-wrap:wrap;
}

.metric-cards{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:20px;
  flex:1;
}

.metric-card{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:24px;
  position:relative;
  overflow:hidden;
  transition:all 0.3s ease;
  cursor:pointer;
}
.metric-card::before{
  content:'';
  position:absolute;
  top:0;left:0;
  width:100%;height:4px;
  background:linear-gradient(90deg,var(--accent-blue),var(--accent-cyan));
  transform:scaleX(0);
  transform-origin:left;
  transition:transform 0.3s ease;
}
.metric-card:hover::before{
  transform:scaleX(1);
}
.metric-card:hover{
  transform:translateY(-8px);
  box-shadow:0 20px 60px rgba(0,0,0,0.4);
  border-color:var(--accent-blue);
}

.metric-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:16px;
}
.metric-icon{
  width:56px;height:56px;
  border-radius:16px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:28px;
  position:relative;
}
.metric-icon.heart{
  background:linear-gradient(135deg,#ef4444,#dc2626);
  box-shadow:0 8px 24px var(--glow-red);
}
.metric-icon.oxygen{
  background:linear-gradient(135deg,#06b6d4,#0891b2);
  box-shadow:0 8px 24px rgba(6,182,212,0.4);
}
.metric-icon.battery{
  background:linear-gradient(135deg,#10b981,#059669);
  box-shadow:0 8px 24px var(--glow-green);
}
.metric-icon i{
  animation:icon-float 3s infinite ease-in-out;
}
@keyframes icon-float{
  0%,100%{transform:translateY(0);}
  50%{transform:translateY(-5px);}
}

.metric-trend{
  padding:6px 12px;
  border-radius:8px;
  font-size:12px;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:4px;
}
.trend-up{
  background:rgba(16,185,129,0.1);
  color:var(--accent-green);
}
.trend-down{
  background:rgba(239,68,68,0.1);
  color:var(--accent-red);
}

.metric-title{
  font-size:14px;
  color:var(--text-secondary);
  font-weight:500;
  margin-bottom:8px;
}
.metric-value{
  font-size:42px;
  font-weight:800;
  line-height:1;
  margin-bottom:8px;
  background:linear-gradient(135deg,var(--text-primary),var(--text-secondary));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.metric-subtitle{
  font-size:12px;
  color:var(--text-muted);
  display:flex;
  align-items:center;
  gap:6px;
}

/* Controls */
.controls{
  display:flex;
  flex-direction:column;
  gap:16px;
  min-width:300px;
}
.control-group{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:20px;
}
.control-label{
  font-size:13px;
  font-weight:600;
  color:var(--text-secondary);
  margin-bottom:8px;
  display:block;
}
.control-select,
.control-input{
  width:100%;
  padding:12px 16px;
  background:var(--bg-secondary);
  border:1px solid var(--border);
  border-radius:10px;
  color:var(--text-primary);
  font-size:14px;
  font-weight:500;
  transition:all 0.3s ease;
}
.control-select:focus,
.control-input:focus{
  outline:none;
  border-color:var(--accent-blue);
  box-shadow:0 0 0 3px rgba(59,130,246,0.1);
}

/* Charts Grid */
.charts-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(500px,1fr));
  gap:24px;
  margin-bottom:32px;
}

.chart-panel{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:28px;
  position:relative;
  overflow:hidden;
}
.chart-panel::before{
  content:'';
  position:absolute;
  top:-100%;
  left:-100%;
  width:300%;
  height:300%;
  background:linear-gradient(45deg,transparent,rgba(59,130,246,0.03),transparent);
  animation:chart-shine 3s infinite;
}
@keyframes chart-shine{
  0%{transform:translate(-100%,-100%);}
  100%{transform:translate(100%,100%);}
}

.chart-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}
.chart-title{
  font-size:18px;
  font-weight:700;
  display:flex;
  align-items:center;
  gap:10px;
}
.chart-title i{
  font-size:20px;
  color:var(--accent-blue);
}
.chart-info{
  padding:8px 16px;
  background:rgba(59,130,246,0.1);
  border-radius:8px;
  font-size:13px;
  color:var(--accent-blue);
  font-weight:600;
}

canvas{
  width:100%!important;
  height:300px!important;
}

/* Logs Section */
.logs-panel{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:20px;
  padding:28px;
  margin-bottom:32px;
}
.logs-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}
.logs-title{
  font-size:20px;
  font-weight:700;
  display:flex;
  align-items:center;
  gap:12px;
}
.logs-actions{
  display:flex;
  gap:12px;
}
.btn-small{
  padding:10px 18px;
  border-radius:10px;
  font-size:13px;
  font-weight:600;
  cursor:pointer;
  border:none;
  transition:all 0.3s ease;
}
.btn-clear{
  background:rgba(239,68,68,0.1);
  color:var(--accent-red);
  border:1px solid var(--accent-red);
}
.btn-clear:hover{
  background:var(--accent-red);
  color:#fff;
}
.btn-export{
  background:linear-gradient(135deg,var(--accent-green),#059669);
  color:#fff;
  box-shadow:0 4px 12px rgba(16,185,129,0.3);
}
.btn-export:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(16,185,129,0.4);
}

.logs-list{
  max-height:400px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:12px;
}
.logs-list::-webkit-scrollbar{
  width:8px;
}
.logs-list::-webkit-scrollbar-track{
  background:var(--bg-secondary);
  border-radius:4px;
}
.logs-list::-webkit-scrollbar-thumb{
  background:var(--accent-blue);
  border-radius:4px;
}

.log-item{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:16px 20px;
  background:var(--bg-secondary);
  border:1px solid var(--border);
  border-radius:12px;
  transition:all 0.3s ease;
}
.log-item:hover{
  border-color:var(--accent-blue);
  transform:translateX(4px);
}
.log-left{
  display:flex;
  align-items:center;
  gap:16px;
}
.log-indicator{
  width:6px;
  height:50px;
  border-radius:3px;
  background:linear-gradient(180deg,var(--accent-red),var(--accent-orange));
}
.log-time{
  font-size:14px;
  font-weight:600;
  color:var(--text-primary);
}
.log-label{
  font-size:12px;
  color:var(--text-muted);
}
.log-values{
  display:flex;
  gap:20px;
  text-align:right;
}
.log-value-item{
  display:flex;
  flex-direction:column;
  align-items:flex-end;
}
.log-number{
  font-size:18px;
  font-weight:700;
  color:var(--text-primary);
}
.log-unit{
  font-size:11px;
  color:var(--text-muted);
}

/* Modal */
.modal{
  position:fixed;
  top:0;left:0;
  width:100%;height:100%;
  background:rgba(10,14,39,0.9);
  backdrop-filter:blur(10px);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:9999;
  animation:modalFadeIn 0.3s ease;
}
@keyframes modalFadeIn{
  from{opacity:0;}
  to{opacity:1;}
}
.modal-content{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:24px;
  padding:40px;
  width:90%;
  max-width:500px;
  position:relative;
  animation:modalSlideIn 0.3s ease;
  box-shadow:0 20px 60px rgba(0,0,0,0.5);
}
@keyframes modalSlideIn{
  from{transform:translateY(-50px);opacity:0;}
  to{transform:translateY(0);opacity:1;}
}
.modal-close{
  position:absolute;
  top:20px;right:20px;
  width:40px;height:40px;
  border-radius:50%;
  background:rgba(239,68,68,0.1);
  color:var(--accent-red);
  border:none;
  font-size:20px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  transition:all 0.3s ease;
}
.modal-close:hover{
  background:var(--accent-red);
  color:#fff;
  transform:rotate(90deg);
}
.modal-title{
  font-size:28px;
  font-weight:800;
  margin-bottom:24px;
  background:linear-gradient(135deg,var(--accent-blue),var(--accent-purple));
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;
}
.form-group{
  margin-bottom:20px;
}
.form-label{
  display:block;
  font-size:13px;
  font-weight:600;
  color:var(--text-secondary);
  margin-bottom:8px;
}
.form-input{
  width:100%;
  padding:14px 18px;
  background:var(--bg-secondary);
  border:1px solid var(--border);
  border-radius:12px;
  color:var(--text-primary);
  font-size:14px;
  transition:all 0.3s ease;
}
.form-input:focus{
  outline:none;
  border-color:var(--accent-blue);
  box-shadow:0 0 0 4px rgba(59,130,246,0.1);
}
.btn-save{
  width:100%;
  padding:16px;
  background:linear-gradient(135deg,var(--accent-blue),var(--accent-purple));
  color:#fff;
  border:none;
  border-radius:12px;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
  transition:all 0.3s ease;
  margin-top:8px;
}
.btn-save:hover{
  transform:translateY(-2px);
  box-shadow:0 12px 32px rgba(59,130,246,0.4);
}

/* Footer */
.footer{
  text-align:center;
  padding:20px;
  color:var(--text-muted);
  font-size:14px;
}

/* Responsive */
@media(max-width:768px){
  .navbar{
    flex-direction:column;
    gap:16px;
  }
  .charts-grid{
    grid-template-columns:1fr;
  }
  .metric-cards{
    grid-template-columns:1fr;
  }
  .top-section{
    flex-direction:column;
  }
}
</style>
</head>
<body>

<div class="animated-bg"></div>

<nav class="navbar">
  <div class="brand">
    <div class="icon-pulse">
      <i class="fas fa-heartbeat"></i>
    </div>
    <span>Health Monitor Pro</span>
  </div>
  <div class="nav-right">
    <button class="btn btn-emergency" onclick="triggerEmergency()">
      <i class="fas fa-exclamation-triangle"></i>
      <span>EMERGENCY</span>
    </button>
    <button class="btn btn-profile" onclick="openProfile()">
      <i class="fas fa-user-circle"></i>
      <span>Patient Profile</span>
    </button>
    <div class="status-indicator">
      <div class="status-dot" id="connDot"></div>
      <div>
        <div class="status-text" id="connText">Connecting...</div>
        <div class="status-subtext">Firebase Database</div>
      </div>
    </div>
  </div>
</nav>

<div id="criticalAlert">
  <i class="fas fa-exclamation-circle"></i> CRITICAL ALERT!
</div>

<div class="container">
  <div class="top-section">
    <div class="metric-cards">
      <div class="metric-card">
        <div class="metric-header">
          <div class="metric-icon heart">
            <i class="fas fa-heartbeat"></i>
          </div>
          <div class="metric-trend trend-up" id="hrTrend">
            <i class="fas fa-arrow-up"></i>
            <span>Normal</span>
          </div>
        </div>
        <div class="metric-title">Heart Rate</div>
        <div class="metric-value" id="hrValue">--</div>
        <div class="metric-subtitle">
          <i class="far fa-clock"></i>
          <span id="hrSmall">Last update: --</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-header">
          <div class="metric-icon oxygen">
            <i class="fas fa-wind"></i>
          </div>
          <div class="metric-trend trend-up" id="spTrend">
            <i class="fas fa-arrow-up"></i>
            <span>Normal</span>
          </div>
        </div>
        <div class="metric-title">SpO₂ (Oxygen)</div>
        <div class="metric-value" id="spValue">--</div>
        <div class="metric-subtitle">
          <i class="far fa-clock"></i>
          <span id="spSmall">Last update: --</span>
        </div>
      </div>

      <div class="metric-card">
        <div class="metric-header">
          <div class="metric-icon battery">
            <i class="fas fa-battery-three-quarters"></i>
          </div>
          <div class="metric-trend trend-up" id="batTrend">
            <i class="fas fa-check"></i>
            <span>Good</span>
          </div>
        </div>
        <div class="metric-title">Battery Level</div>
        <div class="metric-value" id="batValue">--</div>
        <div class="metric-subtitle">
          <i class="far fa-clock"></i>
          <span id="batSmall">Last update: --</span>
        </div>
      </div>
    </div>

    <div class="controls">
      <div class="control-group">
        <label class="control-label" for="patientSelect">
          <i class="fas fa-user-injured"></i> Select Patient
        </label>
        <select class="control-select" id="patientSelect">
          <option value="patient1">Patient 1</option>
          <option value="patient2">Patient 2</option>
          <option value="patient3">Patient 3</option>
        </select>
      </div>
      <div class="control-group">
        <label class="control-label" for="dateSelect">
          <i class="far fa-calendar-alt"></i> Select Date
        </label>
        <input type="date" class="control-input" id="dateSelect"/>
      </div>
    </div>
  </div>

  <div class="charts-grid">
    <div class="chart-panel">
      <div class="chart-header">
        <div class="chart-title">
          <i class="fas fa-chart-line"></i>
          Heart Rate Monitoring
        </div>
        <div class="chart-info">Normal: 60-100 bpm</div>
      </div>
      <canvas id="hrChart"></canvas>
    </div>

    <div class="chart-panel">
      <div class="chart-header">
        <div class="chart-title">
          <i class="fas fa-chart-area"></i>
          SpO₂ Monitoring
        </div>
        <div class="chart-info">Normal: 95-100%</div>
      </div>
      <canvas id="spChart"></canvas>
    </div>
  </div>

  <div class="logs-panel">
    <div class="logs-header">
      <div class="logs-title">
        <i class="fas fa-history"></i>
        Recent Updates
      </div>
      <div class="logs-actions">
        <button class="btn-small btn-clear" id="clearBtn">
          <i class="fas fa-trash-alt"></i> Clear
        </button>
        <button class="btn-small btn-export" id="exportBtn">
          <i class="fas fa-download"></i> Export CSV
        </button>
      </div>
    </div>
    <div class="logs-list" id="logList"></div>
  </div>

  <div class="footer">
    <i class="fas fa-shield-alt"></i> Dashboard ready — live updates from ESP32 via Firebase Realtime Database
  </div>
</div>

<div class="modal" id="profileModal">
  <div class="modal-content">
    <button class="modal-close" onclick="closeProfile()">
      <i class="fas fa-times"></i>
    </button>
    <h2 class="modal-title">
      <i class="fas fa-user-circle"></i> Patient Profile
    </h2>
    <div class="form-group">
      <label class="form-label" for="pName">Full Name</label>
      <input type="text" class="form-input" id="pName" placeholder="Enter patient name"/>
    </div>
    <div class="form-group">
      <label class="form-label" for="pAge">Age</label>
      <input type="number" class="form-input" id="pAge" placeholder="Enter age"/>
    </div>
    <div class="form-group">
      <label class="form-label" for="pGender">Gender</label>
      <input type="text" class="form-input" id="pGender" placeholder="Male/Female"/>
    </div>
    <div class="form-group">
      <label class="form-label" for="pAddress">Address</label>
      <input type="text" class="form-input" id="pAddress" placeholder="Enter address"/>
    </div>
    <button class="btn-save" onclick="saveProfile()">
      <i class="fas fa-save"></i> Save Profile
    </button>
  </div>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyDvhMOPLbL_k6vvBDOjRYglO5io3wbOMTU",
  authDomain: "health-monitor-438c2.firebaseapp.com",
  databaseURL: "https://health-monitor-438c2-default-rtdb.firebaseio.com",
  projectId: "health-monitor-438c2",
}